{"_commonSettings":{"type":"map","access":[{"role":"guest","permissions":"crud","condition":null},{"role":"all","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","i18n":{"en":{"comments":{"label":"Comments","placeholder":"Write..."},"common":{"actionError":"Something went wrong: ","apply":"Apply","cancel":"Cancel","datePattern":"DD.MM.YYYY","dateTimePattern":"DD.MM.YYYY HH:MM","email":"E-mail address","language":"Language","loadingData":"loading data","month":"Month","password":"Password","recordsOnPage":"Records on page: ","saved":"changes saved","today":"Today","userName":"Login","week":"Week","yesterday":"Yesterday"},"errors":{"EMAIL_NOT_FOUND":"E-mail address not found","INVALID_OLD_PASSWORD":"Invalid old password","PASSWORD_NOT_MATCHED":"Invalid password","action":"Sorry, but we unable to process your request","common":"Something went wrong...","delete":"Delete error","emailInvalid":"Invalid e-mail","emailUsed":"E-mail in use","invalidPattern":"Incorrect format","requiredField":"Required field","save":"Error while saving changes"},"filters":{"all":"All","clear":"reset","enterSearchText":"Search","search":"Search","title":"Filter"},"form":{"addToObjectList":"Add","all":"All","cancel":"Cancel","delete":"Delete","deleted":"Item deleted","dropFile":"or drop here","e404":"There is no such object","e404prompt":"Please create one or select from list","emptyPreview":"Please select element from list...","filterNotMatch":"Selected object does not match filter conditions","moved":"Item moved to another folder","newObject":"New object","notSaved":"Not saved – ","openMoved":"Show","pickFile":"Choose file","save":"Save","selected":"Selected"},"install":{"accept":"Accept","createRoot":"Create root account","hello":"Hi, let's start now","license":"License agreement","next":"Next"},"lists":{"empty":"Looks like there is nothing here...","new":"Creating item","notFound":"Nothing found"},"notifications":{"empty":"No notifications","previously":"Previously"},"profile":{"changeLogin":"Login change","link":"Profile","newLogin":"New login","passwordSaved":"Password did change","saved":"Profile info did save","title":"Profile"},"resetPassword":{"action":"change","newPassword":"New password","oldPassword":"Current password","successEmailSubject":"Password was changed","title":"Password change"},"sendResetLink":{"action":"Send link","emailSubject":"Password restore","link":"I forgot password","title":"Password restore"},"signIn":{"action":"Sign in","error":"Login or password incorrect","restoreLinkSent":"Email with recent link sent. If you provide correct address, you will receive it within 10 minutes","title":"Sign in"},"signOut":{"action":"Sign out"},"signUp":{"action":"Register","activationEmailSubject":"Account activation","eulaCheck":"I accept the terms in the license agreement","invalidEmail":"Invalid email","loginInUse":"E-mail already in use","registrationSuccessEmailSubject":"Congratulations with registration","subscribeCheck":"I want to receive information e-mails","success":"Successful registration. You can sign in now using your e-mail and password.","successNeedActivation":"An activation email has been sent to the email address provided.","title":"Registration"}},"ru":{"comments":{"label":"Комментарии","placeholder":"Написать..."},"common":{"actionError":"Что-то пошло не так: ","apply":"Применить","cancel":"Отменить","datePattern":"ДД.ММ.ГГГГ","dateTimePattern":"ДД.ММ.ГГГГ ЧЧ:ММ","email":"Адрес электронной почты","language":"Язык","loadingData":"загрузка данных","month":"Месяц","password":"Пароль","recordsOnPage":"Строк на странице: ","saved":"изменения сохранены","today":"Сегодня","userName":"Имя пользователя","week":"Неделя","yesterday":"Вчера"},"errors":{"EMAIL_NOT_FOUND":"E-mail адрес не найден","INVALID_OLD_PASSWORD":"Старый пароль не правильный","PASSWORD_NOT_MATCHED":"Неверный пароль","action":"Ошибка","common":"Ой, что-то пошло не так...","delete":"Ошибка при удалении","emailInvalid":"Некорректный e-mail","emailUsed":"E-mail занят","invalidPattern":"Неверный формат","requiredField":"Обязательное поле","save":"Ошибка при сохранении изменений"},"filters":{"all":"Все","clear":"Сбросить","enterSearchText":"Поиск","search":"Поиск","title":"Фильтр"},"form":{"addToObjectList":"Добавить","all":"Все","cancel":"Отменить","delete":"Удалить","deleted":"Объект удален","dropFile":"или перетащите сюда","e404":"Ой, а такого объекта у нас нет...","e404prompt":"Можно выбрать что-нибудь другое из списка или добавить новую запись","emptyPreview":"Выберите объект для отображения...","filterNotMatch":"Выбранный объект не попадает под условия фильтра","moved":"Объект перемещен в другую папку","newObject":"Новый объект","notSaved":"Не сохранено – ","openMoved":"Показать","pickFile":"Выберите файл","save":"Сохранить","selected":"Выбранные"},"install":{"accept":"Принять","createRoot":"Создание аккаунта администратора","hello":"Привет. Скоро начнем.","license":"Лицензионное соглашение","next":"Далее"},"lists":{"empty":"Похоже, тут ничего нет...","new":"Добавление записи","notFound":"Ничего не найдено"},"notifications":{"empty":"Уведомлений нет","previously":"Ранее"},"profile":{"changeLogin":"Изменение имени пользователя","link":"Профиль","newLogin":"Новое имя пользователя","passwordSaved":"Пароль изменен","saved":"Данные профиля сохранены","title":"Профиль"},"resetPassword":{"action":"Сменить пароль","newPassword":"Новый пароль","oldPassword":"Текущий пароль","successEmailSubject":"Пароль успешно изменён","title":"Изменение пароля"},"sendResetLink":{"action":"Отправить ссылку","emailSubject":"Восстановление пароля","link":"Я забыл пароль","title":"Восстановление пароля"},"signIn":{"action":"Войти","error":"Неверное имя пользователя или пароль","restoreLinkSent":"Письмо со ссылкой для сброса пароля отправлено. Если был указан корректный адрес, вы получите письмо в течение 10 минут","title":"Вход"},"signOut":{"action":"Выйти"},"signUp":{"action":"Зарегистрироваться","activationEmailSubject":"Активация аккаунта","eulaCheck":"Я принимаю условия лицензионного соглашения","invalidEmail":"Неправильный адрес email","loginInUse":"E-mail занят","registrationSuccessEmailSubject":"Поздравляем с регистрацией","subscribeCheck":"Я согласен получать рассылку","success":"Регистрация прошла успешно. Вы можете войти, используя свои e-mail и пароль.","successNeedActivation":"На указанный вами адрес отправлено письмо для активации аккаунта.","title":"Регистрация"}}},"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"entries":{"defaultLocale":"ru","jwtExtraProps":["roles","lang"],"lessVars":{},"links":[],"locales":["ru"],"meta":[{"content":"Application description","name":"description"},{"content":"Application author","name":"author"}],"resetPasswordDisabled":true,"resetPasswordProps":{"password":{"display":"password","formOrder":2,"label":"{{$i18n.$settings.resetPassword.newPassword}}","required":true,"type":"string"}},"resetPasswordRequestProps":{"email":{"display":"textInput","label":"{{$i18n.$settings.common.email}}","pattern":{"expression":"^\\S+@\\S+\\.\\S+$","message":"{{$i18n.$settings.signUp.invalidEmail}}"},"required":true,"type":"string"}},"scripts":[],"signInLogo":"/mooxLogo.png","signInProps":{"login":{"display":"textInput","formOrder":1,"label":"{{$i18n.$settings.common.email}}","required":true,"type":"string"},"password":{"display":"password","formOrder":2,"label":"{{$i18n.$settings.common.password}}","required":true,"type":"string"}},"signUpDisabled":true,"signUpProps":{"email":{"display":"newUsernameInput","formOrder":1,"label":"{{$i18n.$settings.common.email}}","pattern":{"expression":"^\\S+@\\S+\\.\\S+$","message":"{{$i18n.$settings.signUp.invalidEmail}}"},"required":true,"type":"string"},"eula":{"display":"checkbox","formOrder":4,"label":"{{{$i18n.$settings.signUp.eulaCheck}}}","required":true,"type":"bool"},"password":{"display":"password","formOrder":2,"label":"{{$i18n.$settings.common.password}}","required":true,"type":"string"}},"title":"Callforce Clients Control","userActivation":false},"navOrder":0,"display":"","html":"","store":""},"_default":{"type":"directory","groupAccess":"","ownerAccess":"","i18n":null,"props":{"_deleted":{"name":"","type":"bool","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"_id":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","readOnly":true,"required":true,"configurable":true},"_ownerId":{"name":"","type":"ref","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true,"store":"users","configurable":true},"createdAt":{"name":"","type":"date","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","configurable":true},"createdBy":{"name":"","type":"ref","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","store":"users"},"deletedAt":{"name":"","type":"date","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"deletedBy":{"name":"","type":"ref","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","store":"users"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"headerInput","configurable":true},"updatedAt":{"name":"","type":"date","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"updatedBy":{"name":"","type":"ref","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","store":"users"}},"filters":{"_default":{"display":"","multi":false,"query":{"name":{"$options":"i","$regex":"$value"}}}},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"_defaultNotifications":{"type":"notification","access":[{"role":"all","permissions":"rdv","condition":{"_ownerId":{"$expression":"$user._id"}}},{"role":"root","permissions":"rdv","condition":{"_ownerId":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","i18n":null,"props":{"_id":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","readOnly":true},"details":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"event":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"level":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"message":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"relatedObjects":{"name":"","type":"objectList","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","props":{"_id":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"mode":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"store":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"}}},"ttl":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","min":0}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"_defaultProcess":{"type":"process","groupAccess":"","ownerAccess":"","i18n":null,"props":{"_result":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","configurable":true},"_state":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","configurable":true}},"filters":{"_state":{"display":"","conditions":[{"property":"_state","value":null,"operator":"="}],"multi":false}},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"_defaultSingle":{"type":"single","groupAccess":"","ownerAccess":"","i18n":null,"props":{"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"_nav":{"type":"map","groupAccess":"","ownerAccess":"","i18n":null,"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"entries":{"clients":{"label":"Клиенты","navOrder":10},"config":{"label":"Администрирование","navOrder":1000},"moox":{"label":"MOOX","navOrder":20},"test":{"label":"Тестовая зона","navOrder":30}},"navOrder":0,"display":"","html":"","store":""},"_roles":{"type":"map","groupAccess":"","ownerAccess":"","i18n":null,"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"entries":{"admin":{"label":"Администратор"},"all":{"display":"none","label":"all"},"employee":{"label":"Сотрудник"},"root":{"display":"none","label":"root"}},"navOrder":0,"display":"","html":"","store":""},"_serverSettings":{"type":"map","groupAccess":"","ownerAccess":"","i18n":null,"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"storeActions":[{"_id":"restdoc","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"","multi":false,"script":"\n                    let fs = require(\"fs\");\n                    let hs = require(\"handlebars\");\n                    hs.registerHelper(\"toJSON\", function (object) {\n                        return new hs.SafeString(JSON.stringify(object));\n                    });\n                    let src, partial;\n                    return fs.readLib(\"templates/rest-api-template.html\").then(res =\u003e {\n                        src = res;\n                        return fs.readLib(\"templates/rest-api-list-partial.html\");\n                    }).then(res =\u003e {\n                        partial = res;\n                        let template = hs.compile(src);\n                        hs.registerPartial(\"propsList\", partial);\n                        return template({ config: $data });\n                    });\n                ","groupAccess":"","ownerAccess":"","props":null}],"entries":{"passwordResetTokenExpiration":"0:10","registerTokenExpiration":"0:60","ssoOrigins":["http://localhost:8080/"]},"navOrder":0,"display":"","html":"","store":""},"agentDistFiles":{"type":"file","access":[{"role":"guest","permissions":"r","condition":null},{"role":"employee","permissions":"vcru","condition":null},{"role":"admin","permissions":"vcrudx","condition":null}],"groupAccess":"","ownerAccess":"","i18n":null,"props":{"component":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true,"default":"agentDist"},"name":{"name":"","label":"name","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"none","html":"","store":""},"apps":{"type":"process","groupAccess":"","ownerAccess":"","navGroup":"test","i18n":{"storeLabel":"Приложения"},"headerProperty":"title","props":{"_state":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":"1"},"addWindow":{"name":"","label":" ","type":"action","formTab":"windows","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","actions":[{"_id":"addWindow","className":"btn btn-accent"}]},"appId":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"appType":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"appTypeString":{"name":"","type":"virtual","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","load":"\n                    switch ($item._state) {\n                        case \"1\":\n                            return \"Приложение\";\n                        case \"2\":\n                            return \"Окно\";\n                        case \"3\":\n                            return \"Виртуальное приложение\";\n                    }\n                "},"categoryUUID":{"name":"","label":"Категория","type":"ref","formTab":"main","formOrder":60,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"appsCategories"},"color":{"name":"","label":"Цвет","type":"string","formTab":"main","formOrder":50,"groupAccess":"","ownerAccess":"","display":"colorPicker","options":["#11a0d2","#fcc100","#14e01b","#143de0","#3fb0e8","#ff8600","#ff0700","#9C27B0","#CDDC39","#009688"]},"filter":{"name":"","label":"Фильтр","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item._state === '1'","tooltip":"Можно вводить регулярные выражения. \u003cbr\u003eДля этого стоит использовать синтаксис Javascript. \u003cbr\u003eНапример, начало и конец строки обрамить символом \"/\""},"icon":{"name":"","label":"Иконка","type":"string","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"textInput"},"parentIds":{"name":"","type":"any","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"parentUUIDs":{"name":"","label":"Окно приложения","type":"refList","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["title"],"store":"apps","hidden":"$item._state === '1'","disabled":true},"path":{"name":"","label":"Путь","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item._state !== '1'"},"productivity":{"name":"","label":"Продуктивность","type":"int","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"select","options":[{"label":"Полезное","value":1},{"label":"Вредное","value":2}]},"title":{"name":"","label":" ","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true},"windows":{"name":"","label":" ","type":"virtualRefList","formTab":"windows","formOrder":20,"groupAccess":"","ownerAccess":"","display":"","tableColumns":[{"label":"Название","prop":"title","tableLink":true},{"label":"Тип","prop":"appTypeString"},{"label":"Фильтр","prop":"filter"}],"store":"apps","foreignKey":"parentUUIDs","hidden":"$item._state !== '1'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"apps\").willSave($item);\n            ","willSave":"\n                return require(\"apps\").willSave($item);\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Конфигурация"},{"_id":"windows","label":"Окна"}],"states":{"1":{"label":"Приложения","navOrder":10},"2":{"label":"Окна","navOrder":20},"3":{"label":"Виртуальные приложения","navOrder":30}},"actions":[{"_id":"addWindow","disableItemReadyCheck":false,"hidden":"$item._state !== '1'","hideInHeader":false,"showInList":false,"icon":"","label":"Добавить окно","multi":false,"script":"\n                const fn = async () =\u003e {\n                    let item;\n                    if ($data.appId) {\n                        const window = await $db.get(\"apps\", $data.appId);\n                        if (window.parentUUIDs.includes($item._id)) {\n                            throw new UserError(`Окно \"${window.title}\" уже принадлежит приложению \"${$item.title}\"`);\n                        }\n\n                        window.parentUUIDs.push($item._id);\n                        window.parentIds.push($item.appId);\n                        item = { _id: window._id, title: window.title, parentUUIDs: window.parentUUIDs, parentIds: window.parentIds };\n                    } else {\n                        let categoryUUID, categoryId;\n                        if ($data.categoryId) {\n                            const category = await $db.get(\"appsCategories\", $data.categoryId);\n                            categoryUUID = category._id;\n                            categoryId = category.numberId;\n                        } else {\n                            categoryUUID = $item.categoryUUID;\n                            categoryId = $item.categoryId;\n                        }\n\n                        item = {\n                            _id: $db.newId(),\n                            title: $data.title,\n                            filter: $data.filter,\n                            parentIds: [$item.appId],\n                            parentUUIDs: [$item._id],\n                            _state: $data.virtualApp ? \"3\" : \"2\",\n                            appType: $data.virtualApp ? 3 : 2,\n                            productivity: $data.productivity ? $data.productivity : $item.productivity,\n                            categoryUUID,\n                            categoryId\n                        };\n                    }\n\n                    await $db.set(\"apps\", item);\n                    const message = {\n                        event: \"notification\",\n                        level: \"info\",\n                        message: `Создано окно для приложения ${$item.title}`,\n                        details: \"Для перехода в созданное окно, кликните по ссылке\",\n                        relatedObjects: [{\n                            name: item.title,\n                            _id: item._id,\n                            mode: \"link\",\n                            store: \"apps\"\n                        }]\n                    };\n                    const receivers = [$user._id];\n\n                    return $db.notify(\"mainNotifications\", receivers, message);\n                };\n\n                return fn();\n            ","groupAccess":"","ownerAccess":"","props":{"appId":{"name":"","label":"Существующее окно","type":"ref","formOrder":5,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["title"],"store":"apps","extraQuery":{"_state":{"$ne":"1"}}},"categoryId":{"name":"","label":"Категория","type":"ref","formGroup":"Новое окно","formOrder":30,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"appsCategories","hidden":"$item.appId","tooltip":"Если категория для окна не выбрана, будет назначена категория приложения"},"filter":{"name":"","label":"Фильтр","type":"string","formGroup":"Новое окно","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","required":"!$item.appId","hidden":"$item.appId","tooltip":"Можно вводить регулярные выражения. \u003cbr\u003eДля этого начало и конец строки обрамить символом \"/\""},"productivity":{"name":"","label":"Продуктивность","type":"int","formGroup":"Новое окно","formOrder":25,"groupAccess":"","ownerAccess":"","display":"select","hidden":"$item.appId","tooltip":"Если продуктивность для окна не выбрана, будет назначена продуктивность приложения","options":[{"label":"Полезное","value":1},{"label":"Вредное","value":2}]},"title":{"name":"","label":"Название","type":"string","formGroup":"Новое окно","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":"!$item.appId","hidden":"$item.appId"},"virtualApp":{"name":"","label":"Виртуальное приложение","type":"bool","formGroup":"Новое окно","formOrder":30,"groupAccess":"","ownerAccess":"","display":"checkbox","hidden":"$item.appId"}}}],"navOrder":10,"display":"list","html":"","label":"{{$i18n.storeLabel}}","labels":[{"text":"Приложение","showInList":1,"hidden":"$item._state != '1'"},{"text":"Окно","showInList":1,"hidden":"$item._state != '2'"},{"text":"Виртуальное приложение","showInList":1,"hidden":"$item._state != '3'"}],"orderBy":"title","store":""},"appsCategories":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"test","i18n":{"storeLabel":"Категории приложений"},"props":{"numberId":{"name":"","label":"Номер категории","type":"int","formOrder":10,"groupAccess":"","ownerAccess":"","display":"numberInput","placeholder":"Номер будет назначен автоматически","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return $db.nextSequence(\"appCategoryId\").then(res =\u003e $item.numberId = res);\n            "},"storeLifeCycle":{},"formTabs":null,"navOrder":20,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"title","store":""},"avatars":{"type":"file","groupAccess":"","ownerAccess":"","i18n":null,"props":{"name":{"name":"","label":"name","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"none","html":"","store":""},"cfAgentBackReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы cfAgentBack"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":true},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"minor":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","disabled":true},"services":{"name":"","label":"Сервисы","type":"string","formTab":"main","formOrder":50,"groupAccess":"","ownerAccess":"","display":"textArea","hidden":"!$item.services","disabled":true},"sourceMapFile":{"name":"","label":"ZIP файл с sourse maps","type":"file","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"","store":"releaseFiles","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true,"disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[cfAgentBackReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":20,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"cfAgentBack\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfAgentBack\", \"cfAgentBackReleases\", $request);\n            "},{"uri":"sourcemaps/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfAgentBack\", \"cfAgentBackReleases\", $request, true);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"cfAgentPageReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы cfAgentPage"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`cfAgentPage-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[cfAgentPageReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":60,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"cfAgentPage\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfAgentPage\", \"cfAgentPageReleases\", $request);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"cfAsteriskReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы cfAsterisk"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":true},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"minor":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","disabled":true},"services":{"name":"","label":"Сервисы","type":"string","formTab":"main","formOrder":50,"groupAccess":"","ownerAccess":"","display":"textArea","hidden":"!$item.services","disabled":true},"sourceMapFile":{"name":"","label":"ZIP файл с sourse maps","type":"file","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"","store":"releaseFiles","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true,"disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[cfAsteriskReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":30,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"cfAsterisk\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfAsterisk\", \"cfAsteriskReleases\", $request);\n            "},{"uri":"sourcemaps/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfAsterisk\", \"cfAsteriskReleases\", $request, true);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"cfToolsReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы cfTools"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":true},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"minor":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","required":true},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","disabled":true},"sourceMapFile":{"name":"","label":"ZIP файл с sourse maps","type":"file","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"","store":"releaseFiles","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true,"disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[cfToolsReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":40,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"cfTools\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfTools\", \"cfToolsReleases\", $request);\n            "},{"uri":"sourcemaps/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"cfTools\", \"cfToolsReleases\", $request, true);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"clients":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"clients","i18n":{"storeLabel":"Клиенты"},"props":{"address":{"name":"","label":"Адрес","type":"string","formTab":"main","formGroup":"Юридическая информация","formOrder":40,"groupAccess":"","ownerAccess":"","display":"textArea"},"agentDist":{"name":"","label":"Дистрибутив агента","type":"file","formTab":"agent","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","store":"agentDistFiles"},"amiHost":{"name":"","label":"CF_AMI_HOST","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Хост сервера AMI для подключения AsteriskConnector"},"amiPort":{"name":"","label":"CF_AMI_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":28,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Порт сервера AMI для подключения AsteriskConnector"},"authPort":{"name":"","label":"CF_AUTH_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Порт сервиса авторизации"},"autoCallType":{"name":"","label":"Автоопределение направления звонка","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":35,"groupAccess":"","ownerAccess":"","display":"checkbox","tooltip":"Выставляется путём анализа номеров абонентов и списка операторов"},"autoOfflineTime":{"name":"","label":"Автовыход через, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":140,"groupAccess":"","ownerAccess":"","display":"numberInput"},"autoPauseTime":{"name":"","label":"Автопауза через, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":130,"groupAccess":"","ownerAccess":"","display":"numberInput"},"balance":{"name":"","label":"Баланс","type":"int","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"numberInput","disabled":true},"cfAgentBackCronJob":{"name":"","label":"Скрипт планировщика задач для cfAgentBack","type":"string","formTab":"cron","formOrder":10,"groupAccess":"","ownerAccess":"","display":"codeEditor"},"clientId":{"name":"","label":"CLIENT_ID","type":"virtual","formTab":"config","formGroup":"Переменные окружения","formOrder":5,"groupAccess":"","ownerAccess":"","display":"textInput","load":"\n                    return $item.uniqueId;\n                ","disabled":true,"tooltip":"Уникальный номер клиента"},"contactsIds":{"name":"","label":"Контактные лица","type":"refList","formTab":"main","formOrder":60,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"contacts"},"debugFailuresMails":{"name":"","label":"Получатели писем о сбоях (email через запятую)","type":"string","formTab":"config","formGroup":"Настройки","formOrder":170,"groupAccess":"","ownerAccess":"","display":"textArea"},"eventsocketPort":{"name":"","label":"CF_EVENTSOCKET_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":15,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Порт, на котором будет работать EventSockerListener"},"filterDirectCalls":{"name":"","label":"Фильтровать прямые вызовы?","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":37,"groupAccess":"","ownerAccess":"","display":"checkbox"},"filterRecursiveCalls":{"name":"","label":"Фильтровать рекурсивные вызовы?","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":36,"groupAccess":"","ownerAccess":"","display":"checkbox"},"httpStaticPort":{"name":"","label":"CF_HTTP_STATIC_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":40,"groupAccess":"","ownerAccess":"","display":"textInput","default":"8889","tooltip":"Порт сервиса раздачи статики"},"inn":{"name":"","label":"ИНН","type":"string","formTab":"main","formGroup":"Юридическая информация","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput"},"isActive":{"name":"","label":"Активен","type":"bool","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"none","disabled":true},"kpp":{"name":"","label":"КПП","type":"string","formTab":"main","formGroup":"Юридическая информация","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput"},"legalName":{"name":"","label":"Полное наименование","type":"string","formTab":"main","formGroup":"Юридическая информация","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textArea"},"link":{"name":"","label":"Ссылка для скачивания","type":"virtual/client","formTab":"agent","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textArea","load":"\"use strict\";\n\nreturn \"http://moox250.voxlink.ru:3001/downloads/moox-agent/\" + $item._id;","hidden":"!$item.agentDist","disabled":true},"maxClericalTime":{"name":"","label":"Максимальное clerical time, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":60,"groupAccess":"","ownerAccess":"","display":"numberInput","disabled":"!$item.useClericalTime"},"maxMissedPauseTime":{"name":"","label":"Минимальное время паузы при пропущенном вызове, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":160,"groupAccess":"","ownerAccess":"","display":"numberInput"},"maxPostProcessingTime":{"name":"","label":"Максимальное время пост-обработок, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":70,"groupAccess":"","ownerAccess":"","display":"numberInput","disabled":"!$item.usePostProcessing"},"minActiveTime":{"name":"","label":"Минимальное активное время, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":150,"groupAccess":"","ownerAccess":"","display":"numberInput"},"minTalkingTime":{"name":"","label":"Минимальное время разговора, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":120,"groupAccess":"","ownerAccess":"","display":"numberInput"},"minWaitingTime":{"name":"","label":"Минимальное время ожидания, c","type":"int","formTab":"config","formGroup":"Настройки","formOrder":110,"groupAccess":"","ownerAccess":"","display":"numberInput"},"mysqlPass":{"name":"","label":"CF_MYSQL_PASS","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":46,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Пароль для mysql"},"mysqlServer":{"name":"","label":"CF_MYSQL_SERVER","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":42,"groupAccess":"","ownerAccess":"","display":"textInput","default":"127.0.0.1:3306","tooltip":"Хост:порт сервера mysql"},"mysqlUser":{"name":"","label":"CF_MYSQL_USER","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":43,"groupAccess":"","ownerAccess":"","display":"textInput","default":"root","tooltip":"Пользователь mysql"},"noPauseFrom":{"name":"","label":"Не включать паузу автоматом после (часов)","type":"int","formTab":"config","formGroup":"Настройки","formOrder":10,"groupAccess":"","ownerAccess":"","display":"numberInput","placeholder":"22"},"noPauseTo":{"name":"","label":"Не включать паузу автоматом до (часов)","type":"int","formTab":"config","formGroup":"Настройки","formOrder":20,"groupAccess":"","ownerAccess":"","display":"numberInput","placeholder":"09"},"nodeEnv":{"name":"","label":"NODE_ENV","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":140,"groupAccess":"","ownerAccess":"","display":"textInput","default":"production"},"pdfPort":{"name":"","label":"CF_PDF_HTTP_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":25,"groupAccess":"","ownerAccess":"","display":"textInput","default":"8898","tooltip":"Порт сервиса формирования PDF отчетов"},"publicPort":{"name":"","label":"CF_PUBLIC_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":7,"groupAccess":"","ownerAccess":"","display":"textInput","default":"3000","tooltip":"Порт, на котором будет доступно веб приложение.\u003cbr\u003eПо умолчанию, 3000"},"releaseDate":{"name":"","label":"Дата установки","type":"date","formTab":"main","formOrder":50,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","required":"$item.releaseId"},"releaseId":{"name":"","label":"Установленный релиз","type":"ref","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"releases"},"serversIds":{"name":"","label":"Серверы","type":"refList","formTab":"main","formOrder":60,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"servers"},"setOnlineByGroupFlag":{"name":"","label":"setOnlineByGroupFlag","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":30,"groupAccess":"","ownerAccess":"","display":"checkbox"},"uniqueId":{"name":"","label":"Уникальный номер","type":"int","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"numberInput","disabled":true},"uri":{"name":"","label":"CF_CLIENT_URI","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":50,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Адрес доступа к клиентскому интерфейсу\u003cbr\u003eПо-умолчанию, moox${item.clientId}.voxlink.ru"},"useClericalTime":{"name":"","label":"Включить clerical time","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":40,"groupAccess":"","ownerAccess":"","display":"checkbox"},"usePostProcessing":{"name":"","label":"Включить пост-обработки","type":"bool","formTab":"config","formGroup":"Настройки","formOrder":50,"groupAccess":"","ownerAccess":"","display":"checkbox"},"webserverPort":{"name":"","label":"CF_WEBSERVER_PORT","type":"string","formTab":"config","formGroup":"Переменные окружения","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","tooltip":"Порт, на котором будет работать веб сервер"}},"filters":{},"objectLifeCycle":{"willCreate":"\n        return $db.nextSequence(\"clients\").then(res =\u003e {\n            $item.uniqueId = 242 + res;\n        });\n    "},"storeLifeCycle":{},"formGroups":["","Юридическая информация","Переменные окружения","Настройки"],"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"config","label":"Конфигурация"},{"_id":"cron","label":"Cron"},{"_id":"agent","label":"Агент"}],"actions":[{"_id":"test","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"test","multi":false,"script":"\n                return {\n                    type: \"JSON\",\n                    data: \"TEST\"\n                };\n            ","type":"http","groupAccess":"","ownerAccess":"","props":null},{"_id":"enable","disableItemReadyCheck":false,"hidden":"$item.isActive","hideInHeader":false,"showInList":false,"icon":"","label":"Активировать","multi":false,"script":"\n                return $db.set(\"clients\", { _id: $item._id, isActive: true });\n            ","groupAccess":"","ownerAccess":"","props":null},{"_id":"disable","disableItemReadyCheck":false,"hidden":"!$item.isActive","hideInHeader":false,"showInList":false,"icon":"","label":"Заблокировать","multi":false,"script":"\n                return $db.set(\"clients\", { _id: $item._id, isActive: false });\n            ","groupAccess":"","ownerAccess":"","props":null}],"navOrder":0,"display":"list","html":"","label":"{{$i18n.storeLabel}}","labels":[{"text":"Активен","showInList":1,"hidden":"!$item.isActive"},{"text":"Заблокирован","showInList":1,"hidden":"$item.isActive"},{"text":"Номер: {{$item.uniqueId}}","showInList":2,"hideInForm":true}],"orderBy":"name","httpHooks":[{"uri":"moox-agent/:clientId","method":"GET","script":"\n                const fn = async () =\u003e {\n                    const $item = await $db.get(\"clients\", $request.params.clientId);\n                    console.debug(\"WILL REDIRECT TO: \", `http:\\/\\/moox250.voxlink.ru:3001/moox-agent/downloads/${($item.agentDist[0] || {})._id}`);\n                    return {\n                        type: \"redirect\",\n                        data: `http:\\/\\/moox250.voxlink.ru:3001/moox-agent/downloads/${($item.agentDist[0] || {})._id}`\n                    };\n                };\n\n                return fn();\n            "}],"store":""},"contacts":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"clients","i18n":{"storeLabel":"Контакты"},"props":{"active":{"name":"","label":"Активен","type":"bool","formTab":"main","formOrder":6,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"admin","permissions":"crud","condition":null},{"role":"employee","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"checkbox","hidden":"!$item.employee"},"changePhotoAction":{"name":"","type":"action","formTab":"main","formOrder":1,"groupAccess":"","ownerAccess":"","display":"","style":{"marginTop":"7px","transform":"translate(-200px, 0)"},"actions":[{"_id":"ava","className":"btn btn-default"}]},"clientId":{"name":"","label":"Место работы","type":"ref","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"clients","hidden":"$item.employee"},"contacts":{"name":"","label":" ","type":"objectList","formTab":"contacts","formOrder":40,"groupAccess":"","ownerAccess":"","display":"","props":{"number":{"name":"","label":" ","type":"string","formOrder":20,"groupAccess":"","ownerAccess":"","display":"masked","style":{"flex":"0 0 200px"},"required":"$item.type === 'mobile' || $item.type === 'work' || $item.type === 'home'","mask":{"expression":"| (|||) |||-||-||","message":"Номер не соотвествует формату"},"hidden":"$item.type === 'im' || $item.type === 'email'"},"type":{"name":"","label":"Тип","type":"string","formOrder":10,"groupAccess":"","ownerAccess":"","display":"select","required":true,"default":"mobile","options":[{"label":"Мобильный","value":"mobile"},{"label":"Рабочий","value":"work"},{"label":"Домашний","value":"home"},{"label":"IM","value":"im"},{"label":"Email","value":"email"}]},"value":{"name":"","label":" ","type":"string","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","style":{"flex":"0 0 200px"},"required":"$item.type === 'im' || $item.type === 'email'","hidden":"$item.type === 'mobile' || $item.type === 'work' || $item.type === 'home'"}}},"description":{"name":"","label":"Дополнительная информация","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"employee":{"name":"","label":"Наш сотрудник","type":"bool","formTab":"main","formOrder":5,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"admin","permissions":"crud","condition":null},{"role":"employee","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"checkbox"},"firstName":{"name":"","label":"Имя","type":"string","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","required":"!$item.lastName"},"lastName":{"name":"","label":"Фамилия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":"!$item.firstName"},"middleName":{"name":"","label":"Отчество","type":"string","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"photo":{"name":"","type":"file","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","store":"avatars"},"photoDisplay":{"name":"","label":"Фото","type":"virtual/client","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"html","style":{"marginRight":"200px","minWidth":"130px","width":"130px"},"html":"\u003cdiv style=\"width: 120px; height: 120px; margin: 7px 0; padding: 5px; background-color: #fff; border-radius: 5px\"\u003e\n                    {{#if value}}\n                    \u003cimg style=\"display: block; margin: 0 auto; max-width: 100%; max-height: 100%; border-radius: 5px\"\n                         src=\"/files/avatars/{{ value }}\"\n                         alt=\"photo\"/\u003e\n                    {{/if}}\n                \u003c/div\u003e","load":"\"use strict\";\n\nif (!$item.photo || $item.photo.length === 0) {\n    return;\n}\nreturn $item.photo[0]._id + (\"?access_token=\" + localStorage.getItem(\"blank-access-token\"));"},"publicKey":{"name":"","label":"Публичный ключ","type":"string","formTab":"main","formOrder":100,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"admin","permissions":"crud","condition":null},{"role":"employee","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"textArea"},"userId":{"name":"","label":"Пользователь","type":"ref","formTab":"main","formOrder":40,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"admin","permissions":"crud","condition":null},{"role":"employee","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"users","hidden":"!$item.employee"}},"filters":{"candidateSchoolId":{"label":"Наш сотрудник","display":"checkbox","multi":false,"query":"\n                    return {\n                        employee: $value\n                    };\n                "}},"objectLifeCycle":{"willCreate":"\n                return require(\"contactsLifeCycle\").willSave($item);\n            ","willSave":"\n                return require(\"contactsLifeCycle\").willSave($item);\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"contacts","label":"Контактная информация"}],"actions":[{"_id":"ava","className":"btn btn-default","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Поменять фото","multi":false,"script":"\n                if (!Array.isArray($data.photo) || $data.photo.length !== 1) {\n                    throw new UserError(\"Ошибка при загрузке фото\");\n                }\n                return $db.set(\"contacts\", { _id: $item._id, photo: $data.photo });\n            ","type":"form","groupAccess":"","ownerAccess":"","formLabel":"Загрузка фотографии","props":{"photo":{"name":"","label":"Выбранный файл","type":"file","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"avatars"}}}],"navOrder":10,"display":"list","html":"","label":"{{$i18n.storeLabel}}","labels":[{"text":"Наш сотрудник","showInList":1,"hidden":"!$item.employee"},{"text":"Активен","showInList":1,"hidden":"!$item.employee || !$item.active"}],"store":""},"emailSettings":{"type":"single","access":[{"role":"root","permissions":"vcrux","condition":null}],"groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"en":{"pluralGenitiveLocal":"Email transport settings","pluralLocal":"Email transport settings","singularAccusativeLocal":"Email transport settings","singularLocal":"Email transport settings"},"ru":{"pluralGenitiveLocal":"Настройки отправки почты","pluralLocal":"Настройки отправки почты","singularAccusativeLocal":"Настройки отправки почты","singularLocal":"Настройки отправки почты"},"tr":{"pluralGenitiveLocal":"Email transport settings","pluralLocal":"Email transport settings","singularAccusativeLocal":"Email transport settings","singularLocal":"Email transport settings"}},"props":{"from":{"name":"","label":"From","type":"string","formOrder":50,"groupAccess":"","ownerAccess":"","display":"textInput"},"host":{"name":"","label":"Host","type":"string","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true},"password":{"name":"","label":"Password","type":"string","formOrder":40,"groupAccess":"","ownerAccess":"","display":"password","required":true},"port":{"name":"","label":"Port","type":"int","formOrder":20,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true},"testMode":{"name":"","label":"Test Mode","type":"bool","formOrder":60,"groupAccess":"","ownerAccess":"","display":"checkbox","default":false},"to":{"name":"","label":"(Test) To","type":"string","formOrder":70,"groupAccess":"","ownerAccess":"","display":"textInput","required":"$item.testMode","hidden":"!$item.testMode"},"username":{"name":"","label":"Username","type":"string","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput","required":true}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"actions":[{"_id":"test","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"Test","multi":false,"script":"\n                    var email = require(\"email\");\n                    var msg = {\n                        to: $data.email,\n                        subject: \"TEST\",\n                        body: $data.body,\n                    };\n                    console.debug(msg);\n                    var e = email.send(msg, function (e) {\n                        if (e != null) {\n                            console.error(e);\n                        }\n                    });\n                    if (e != null) {\n                        return { error: e };\n                    }\n                    return { result: \"SUCCESS\" };\n                ","type":"form","groupAccess":"","ownerAccess":"","props":{"body":{"name":"","label":"Body","type":"","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput","required":true},"email":{"name":"","label":"To","type":"","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true},"subject":{"name":"","label":"Subject","type":"","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","required":true}}}],"navOrder":10,"display":"","html":"","label":"{{$i18n.pluralLocal}}","store":""},"eteryReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы Etery"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`etery-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[eteryReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":60,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"etery\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"etery\", \"eteryReleases\", $request);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"eventBusReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы EventBus"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`eventBus-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[eventBusReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":40,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"eventBus\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"eventBus\", \"eventBusReleases\", $request);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"gochingReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы Goching"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`goching-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[gochingReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":80,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","indexes":[[{"name":1},{"unique":true}]],"store":""},"mainNotifications":{"type":"notification","groupAccess":"","ownerAccess":"","i18n":null,"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"monitoringReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы Monitoring"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`monitoring-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[monitoringReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":50,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","httpHooks":[{"uri":"patch/:branch","method":"POST","script":"\n                return require(\"releases\").nextPatchVersionHandler(\"monitoring\", $request);\n            "},{"uri":"new/:major/:minor/:patch","method":"POST","script":"\n                return require(\"releases\").postNewHandler(\"monitoring\", \"monitoringReleases\", $request);\n            "}],"indexes":[[{"name":1},{"unique":true}]],"store":""},"operators":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"test","i18n":{"storeLabel":"Операторы"},"props":{"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"operatorId":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"phoneNumber":{"name":"","label":"Номер телефона","type":"int","formOrder":20,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true},"queueList":{"name":"","label":"Работает в группах","type":"objectList","formOrder":310,"groupAccess":"","ownerAccess":"","display":"","props":{"isActive":{"name":"","label":"Активен","type":"bool","formOrder":40,"groupAccess":"","ownerAccess":"","display":"checkbox","displayWidth":10,"disabled":true},"queueId":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"queueUUID":{"name":"","label":"Группа","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"required":true,"store":"queues"},"startTime":{"name":"","label":"{{$i18n.startTimeLabel}}","type":"string","formOrder":20,"groupAccess":"","ownerAccess":"","display":"select","displayWidth":20,"style":{"flex":"0 0 140px"},"required":true,"default":"09:00","options":["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"]},"stopTime":{"name":"","label":"{{$i18n.stopTimeLabel}}","type":"string","formOrder":30,"groupAccess":"","ownerAccess":"","display":"select","displayWidth":20,"style":{"flex":"0 0 140px"},"required":true,"default":"17:59","options":["00:29","00:59","01:29","01:59","02:29","02:59","03:29","03:59","04:29","04:59","05:29","05:59","06:29","06:59","07:29","07:59","08:29","08:59","09:29","09:59","10:29","10:59","11:29","11:59","12:29","12:59","13:29","13:59","14:29","14:59","15:29","15:59","16:29","16:59","17:29","17:59","18:29","18:59","19:29","19:59","20:29","20:59","21:29","21:59","22:29","22:59","23:29","23:59"]}}},"title":{"name":"","label":"Имя","type":"string","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"operators\").operatorWillSave($item);\n            ","willSave":"\n                return require(\"operators\").operatorWillSave($item);\n            "},"storeLifeCycle":{},"formTabs":null,"navOrder":30,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"phoneNumber","store":""},"profile":{"type":"","access":[{"role":"root","permissions":"vrux","condition":null},{"role":"all","permissions":"vrux","condition":{"_ownerId":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","navGroup":"profile","i18n":{"_ownerIdLabel":"Учетная запись","changePasswordAction":"Сменить пароль","infoTabLabel":"Информация","invalidPasswordError":"Текущий пароль не совпадает","lastNameLabel":"Фамилия","nameLabel":"Имя","newPasswordLabel":"Новый пароль","oldPasswordLabel":"Текущий пароль","passwordChangedMessage":"Пароль изменён","securityTabLabel":"Безопасность","sessionsLabel":"Сессии","storeLabel":"Профиль"},"props":{"_ownerId":{"name":"","label":"{{$i18n._ownerIdLabel}}","type":"ref","oppositeProp":"profileId","formTab":"info","formOrder":500,"access":[{"role":"all","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["login"],"store":"users","hidden":"($user.roles || []).indexOf('root') \u003c 0","disabled":true},"lastName":{"name":"","label":"{{$i18n.lastNameLabel}}","type":"","formTab":"info","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50},"login":{"name":"","label":"{{$i18n.$stores.users.loginLabel}}","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"textInput"},"name":{"name":"","label":"{{$i18n.nameLabel}}","type":"","formTab":"info","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50},"securityActions":{"name":"","type":"action","formTab":"security","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"changePassword","className":"btn btn-accent"}]},"sessions":{"name":"","label":"{{$i18n.sessionsLabel}}","type":"objectList","formTab":"info","formOrder":1000,"groupAccess":"","ownerAccess":"","display":"","disabled":true,"props":{"apiKey":{"name":"","label":"ID","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"text"},"connections":{"name":"","label":"Active connections","type":"int","formOrder":10,"groupAccess":"","ownerAccess":"","display":"text"}}}},"filters":{"userFilter":{"label":"User","display":"searchBox","searchBy":["name","email","clientId"],"store":"users","filterBy":"_id","multi":true,"query":{"_ownerId":"$value"}}},"objectLifeCycle":{},"storeLifeCycle":{"didStart":"\n                let r = 0;\n                let updateUserSessions = (session) =\u003e {\n                    let _r = ++r;\n                    var locker = \"sessions-update-\" + session.apiKey + \"-__v:\" + session.__v;\n                    console.log(\"Session locker:\", locker);\n                    sync.once(locker, () =\u003e {\n                        let userSessions = sessions.get().filter(s =\u003e s.userId === session.userId).map((s) =\u003e {\n                            return {\n                                apiKey: s.apiKey,\n                                connections: (s.connections || []).length,\n                            };\n                        });\n                        console.log(\"Sessions update for user\", session.userId, \"Sessions:\", JSON.stringify(userSessions));\n                        $db.get(\"profile\", { _ownerId: session.userId }).then((p) =\u003e {\n                            if (_r === r) {\n                                console.log(\"Updating profile sessions\");\n                                $db.set(\n                                    \"profile\",\n                                    { _id: p._id, sessions: userSessions },\n                                    { noValidate: true },\n                                    (e, r) =\u003e {\n                                        console.log(\"Update error:\", e);\n                                    }\n                                );\n                            }\n                        }).catch(() =\u003e {\n                            if (_r === r) {\n                                console.log(\"Profile not found, creating...\");\n                                $db.get(\"users\", session.userId).then(u =\u003e {\n                                    if (u == null) { throw new Error(\"user not found\") }\n                                    return $db.insert(\n                                        \"profile\",\n                                        { _ownerId: session.userId, sessions: userSessions, login: u.login },\n                                        { noValidate: true },\n                                        (e, r) =\u003e {\n                                            console.log(\"Create error:\", e);\n                                        });\n                                }).catch(e =\u003e console.log(\"Error while creating profile for user:\", session.userId));\n                            }\n                        });\n                    });\n                };\n                sessions.on(\"create\", updateUserSessions);\n                sessions.on(\"update\", updateUserSessions);\n                sessions.on(\"delete\", updateUserSessions);\n            "},"formTabs":[{"_id":"info","label":"{{$i18n.infoTabLabel}}"},{"_id":"security","label":"{{$i18n.securityTabLabel}}"}],"actions":[{"_id":"changePassword","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"{{$i18n.changePasswordAction}}","multi":false,"script":"\n                    let i18n = require(\"i18n\");\n                    if (!$data.newPassword || (!$data.oldPassword \u0026\u0026 !$user.noPassword)) {\n                        return \"Invalid args\";\n                    }\n                    let user;\n                    return $db.get(\"users\", $item._ownerId).then((_user) =\u003e {\n                        if (_user._deleted) {\n                            throw new Error();\n                        }\n                        user = _user;\n                        if ($user.noPassword) {\n                            return;\n                        }\n                        if (user.password == null) {\n                            throw new Error();\n                        }\n                        let hash = require(\"hash\");\n                        return hash.calc($data.oldPassword, user.password.salt);\n                    }).then((d) =\u003e {\n                        if (!$user.noPassword \u0026\u0026 d !== user.password.key) {\n                            throw new UserError(i18n.get(\"profile.invalidPasswordError\", $user.lang));\n                        }\n                        return $db.set(\"users\", { _id: $item._ownerId, password: $data.newPassword, noPassword: null });\n                    }).then(d =\u003e {\n                        $db.notify(\"securityNotifications\", [$user._id], {\n                            message: i18n.get(\"profile.passwordChangedMessage\", $user.lang),\n                        });\n                    });\n                ","type":"form","groupAccess":"","ownerAccess":"","props":{"newPassword":{"name":"","label":"{{$i18n.newPasswordLabel}}","type":"string","formOrder":1,"groupAccess":"","ownerAccess":"","display":"password","required":true},"oldPassword":{"name":"","label":"{{$i18n.oldPasswordLabel}}","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"password","required":"!$user.noPassword","hidden":"$user.noPassword"}}}],"navOrder":0,"display":"single","html":"","label":"{{$i18n.storeLabel}}","store":""},"profiles":{"type":"","baseStore":"profile","access":[{"role":"root","permissions":"vrux","condition":null}],"groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"_ownerIdLabel":"Учетная запись","changePasswordAction":"Сменить пароль","infoTabLabel":"Информация","invalidPasswordError":"Текущий пароль не совпадает","lastNameLabel":"Фамилия","nameLabel":"Имя","newPasswordLabel":"Новый пароль","oldPasswordLabel":"Текущий пароль","passwordChangedMessage":"Пароль изменён","securityTabLabel":"Безопасность","sessionsLabel":"Сессии","storeLabel":"Профили"},"headerTemplate":"{{#if $item.login}}{{$item.login}}{{else}}{{$item._ownerId}}{{/if}}","props":{"_ownerId":{"name":"","label":"{{$i18n._ownerIdLabel}}","type":"ref","oppositeProp":"profileId","formTab":"info","formOrder":500,"access":[{"role":"all","permissions":"r","condition":null}],"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["login"],"store":"users","hidden":"($user.roles || []).indexOf('root') \u003c 0","disabled":true},"lastName":{"name":"","label":"{{$i18n.lastNameLabel}}","type":"","formTab":"info","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50},"login":{"name":"","label":"{{$i18n.$stores.users.loginLabel}}","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"textInput"},"name":{"name":"","label":"{{$i18n.nameLabel}}","type":"","formTab":"info","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50},"securityActions":{"name":"","type":"action","formTab":"security","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"changePassword","className":"btn btn-accent"}]},"sessions":{"name":"","label":"{{$i18n.sessionsLabel}}","type":"objectList","formTab":"info","formOrder":1000,"groupAccess":"","ownerAccess":"","display":"","disabled":true,"props":{"apiKey":{"name":"","label":"ID","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"text"},"connections":{"name":"","label":"Active connections","type":"int","formOrder":10,"groupAccess":"","ownerAccess":"","display":"text"}}}},"filters":{"userFilter":{"label":"User","display":"searchBox","searchBy":["name","email","clientId"],"store":"users","filterBy":"_id","multi":true,"query":{"_ownerId":"$value"}}},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":[{"_id":"info","label":"{{$i18n.infoTabLabel}}"},{"_id":"security","label":"{{$i18n.securityTabLabel}}"}],"navOrder":1000,"display":"list","html":"","label":"{{$i18n.storeLabel}}","store":""},"queues":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"test","i18n":{"storeLabel":"Группы операторов"},"props":{"operators":{"name":"","label":"Операторы","type":"virtualRefList","formOrder":20,"groupAccess":"","ownerAccess":"","display":"","tableColumns":[{"label":"Номер телефона","prop":"phoneNumber","tableLink":true},{"label":"Имя","prop":"name","tableLink":true}],"store":"operators","disabled":true,"query":"\n                    return { \"queueList.queueId\": $item.queueId };\n                "},"queueId":{"name":"","type":"int","formOrder":10,"groupAccess":"","ownerAccess":"","display":"none"}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"operators\").queueWillSave($item);\n            ","willSave":"\n                return require(\"operators\").queueWillSave($item);\n            "},"storeLifeCycle":{},"formTabs":null,"navOrder":50,"display":"list","html":"","label":"{{$i18n.storeLabel}}","store":""},"releaseFiles":{"type":"file","groupAccess":"","ownerAccess":"","i18n":null,"props":{"component":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true,"default":"eventBus"},"name":{"name":"","label":"name","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true}},"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"none","html":"","store":""},"releases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы"},"props":{"addDoc":{"name":"","type":"action","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"install","className":"btn btn-default"}]},"codeName":{"name":"","label":"Кодовое название","type":"string","formTab":"main","formOrder":15,"groupAccess":"","ownerAccess":"","display":"textInput","required":true},"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"datePicker"},"version":{"name":"","label":"Версия","type":"int","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"actions":[{"_id":"install","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"Раскатить","multi":false,"script":"\n                const promises = [];\n                ($data.clientId || []).forEach(item =\u003e {\n                    const p = $db.set(\"clients\", { _id: item, releaseId: $item._id, releaseDate: new Date() });\n                    promises.push(p);\n                });\n\n                return Promise.all(promises);\n            ","groupAccess":"","ownerAccess":"","props":{"clientId":{"name":"","label":"Выберите клиентов","type":"refList","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"required":true,"store":"clients"}}}],"navOrder":10,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-version","indexes":[[{"version":1},{"unique":true}]],"store":""},"run":{"type":"","access":[{"role":"root","permissions":"vcrudx","condition":null}],"groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"storeLabel":"Run JS"},"props":{"code":{"name":"","type":"string","formOrder":10,"groupAccess":"","ownerAccess":"","display":"codeEditor"},"name":{"name":"","label":"Script name","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","default":"New script"},"response":{"name":"","type":"string","formOrder":30,"groupAccess":"","ownerAccess":"","display":"code"},"run":{"name":"","type":"action","formOrder":20,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"run"}]}},"filters":{},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"actions":[{"_id":"run","clientPreScript":"\n                    return {\n                        code: $item.code,\n                    };\n                ","disableItemReadyCheck":true,"hideInHeader":false,"showInList":false,"icon":"","label":"Выполнить","multi":false,"script":"\n                    var f = new Function(\"$db\", \"$item\", \"require\", $data.code);\n                    var res = f($db, $item, require);\n                    if (res instanceof Promise) {\n                        return res.then(promiseRes =\u003e {\n                            if (typeof promiseRes !== \"string\") {\n                                promiseRes = JSON.stringify(promiseRes, \"\", \"  \");\n                            }\n                            return $db.set(\"run\", { _id: $item._id, response: promiseRes + \"\" });\n                        }).catch(promiseErr =\u003e {\n                            if (typeof promiseErr !== \"string\") {\n                                promiseErr = JSON.stringify(promiseErr, \"\", \"  \");\n                            }\n                            return $db.set(\"run\", { _id: $item._id, response: \"ERROR: \" + promiseErr });\n                        });\n                    }\n                    if (typeof res !== \"string\") {\n                        res = JSON.stringify(res, \"\", \"  \");\n                    }\n                    return $db.set(\"run\", { _id: $item._id, response: res + \"\" });\n                ","groupAccess":"","ownerAccess":"","props":null}],"navOrder":100,"display":"list","html":"","label":"{{$i18n.storeLabel}}","store":""},"securityNotifications":{"type":"notification","access":[{"role":"root","permissions":"rud","condition":{"_ownerId":{"$expression":"$user._id"}}},{"role":"all","permissions":"rud","condition":{"_ownerId":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","i18n":null,"props":null,"filters":null,"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":0,"display":"","html":"","store":""},"servers":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Серверы"},"props":{"behindVPN":{"name":"","label":"За VPN","type":"bool","formTab":"main","formOrder":50,"groupAccess":"","ownerAccess":"","display":"checkbox"},"cfAgentBackReleaseId":{"name":"","label":"Релиз cfAgentBack","type":"ref","formTab":"components","formOrder":30,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"cfAgentBackReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"cfAgentPageReleaseId":{"name":"","label":"Релиз cfAgentPage","type":"ref","formTab":"components","formOrder":90,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"cfAgentPageReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"cfAsteriskReleaseId":{"name":"","label":"Релиз cfAsterisk","type":"ref","formTab":"components","formOrder":40,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"cfAsteriskReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"cfToolsReleaseId":{"name":"","label":"Релиз cfTools","type":"ref","formTab":"components","formOrder":50,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"cfToolsReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"changeReleaseAction":{"name":"","type":"action","formTab":"components","formOrder":20,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"changeRelease"}]},"clientsList":{"name":"","label":" ","type":"virtualRefList","formTab":"clients","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Имя","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"}],"store":"clients","disabled":true,"query":"\n                    return {\n                        serversIds: $item._id\n                    };\n                "},"description":{"name":"","label":"Описание","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"eteryReleaseId":{"name":"","label":"Релиз Etery","type":"ref","formTab":"components","formOrder":150,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"eteryReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"eventBusReleaseId":{"name":"","label":"Релиз eventBus","type":"ref","formTab":"components","formOrder":60,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"eventBusReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"gochingReleaseId":{"name":"","label":"Релиз Goching","type":"ref","formTab":"components","formOrder":130,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"gochingReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"installationPath":{"name":"","label":"Директория установки","type":"string","formTab":"main","formOrder":45,"groupAccess":"","ownerAccess":"","display":"textInput","default":"/opt/nodeside/","tooltip":"Обычно, это /opt/nodeside/"},"installed":{"name":"","type":"bool","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"ip":{"name":"","label":"IP адрес","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","required":true,"pattern":"^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?).){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$"},"monitoringReleaseId":{"name":"","label":"Релиз Monitoring","type":"ref","formTab":"components","formOrder":70,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"monitoringReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"name":{"name":"","label":"Название сервера","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","required":true},"online":{"name":"","type":"bool","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":false},"os":{"name":"","label":"Версия ОС/Ядра","type":"string","formTab":"main","formOrder":90,"groupAccess":"","ownerAccess":"","display":"textArea","required":true},"protectionEnabled":{"name":"","label":"Включить защиту?","type":"bool","formTab":"main","formOrder":60,"groupAccess":"","ownerAccess":"","display":"checkbox"},"publicKey":{"name":"","label":"Публичный ключ","type":"string","formTab":"main","formOrder":100,"groupAccess":"","ownerAccess":"","display":"textArea"},"releaseId":{"name":"","label":"Релиз","type":"ref","formTab":"components","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"store":"releases","disabled":true},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"remoteAgentUri":{"name":"","label":"Адрес remote-agent-server","type":"string","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textInput"},"sshPort":{"name":"","label":"Порт для подключения по ssh","type":"string","formTab":"main","formOrder":40,"groupAccess":"","ownerAccess":"","display":"textInput","required":true,"tooltip":"Как правило, ssh работает на 22 порту, но бывают исключения"},"sshUser":{"name":"","label":"Пользователь для подключения по ssh","type":"string","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textInput","required":true},"standalone":{"name":"","label":"Отдельная установка","type":"bool","formTab":"main","formOrder":70,"groupAccess":"","ownerAccess":"","display":"checkbox"},"traefikReleaseId":{"name":"","label":"Релиз Traefik","type":"ref","formTab":"components","formOrder":110,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","store":"traefikReleases","disabled":true,"extraQuery":"\n                    if (!$item.releaseVersion) {\n                        return;\n                    }\n\n                    return {\n                        $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                    };\n                "},"updateCfAgentBackAction":{"name":"","type":"action","formTab":"components","formOrder":35,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateCfAgentBackRelease"},{"_id":"restartCfAgentBack"}]},"updateCfAgentPageAction":{"name":"","type":"action","formTab":"components","formOrder":100,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateCfAgentPageRelease"}]},"updateCfAsteriskAction":{"name":"","type":"action","formTab":"components","formOrder":45,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateCfAsteriskRelease"},{"_id":"restartCfAsterisk"}]},"updateCfToolsAction":{"name":"","type":"action","formTab":"components","formOrder":55,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateCfToolsRelease"}]},"updateEteryAction":{"name":"","type":"action","formTab":"components","formOrder":160,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateEteryRelease"},{"_id":"restartEtery"}]},"updateEventBusAction":{"name":"","type":"action","formTab":"components","formOrder":65,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateEventBusRelease"},{"_id":"restartEventBus"}]},"updateGochingAction":{"name":"","type":"action","formTab":"components","formOrder":140,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateGochingRelease"},{"_id":"restartGoching"}]},"updateMonitoringAction":{"name":"","type":"action","formTab":"components","formOrder":80,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateMonitoringRelease"}]},"updateTraefikAction":{"name":"","type":"action","formTab":"components","formOrder":120,"groupAccess":"","ownerAccess":"","display":"","actions":[{"_id":"updateTraefikRelease"},{"_id":"restartTraefik"}]}},"filters":{},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"components","label":"Компоненты"},{"_id":"clients","label":"Клиенты"}],"actions":[{"_id":"setup","disabled":"$item.installed","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"Первоначальная установка","multi":false,"script":"\n                const fn = async () =\u003e {\n                    const asyncModules = require(\"asyncModules\");\n                    let tmpDir = require(\"os\").tmpdir();\n                    const { cloudURI, remoteAgentDist } = await $db.get(\"settings\", \"settings\");\n                    if (!cloudURI) {\n                        throw new UserError(\"Не указан адрес cloud сервера. Укажите его в системных настройках\");\n                    }\n\n                    if (!remoteAgentDist) {\n                        throw new UserError(\"Не указан путь к remote-agent. Укажите его в системных настройках\");\n                    }\n\n                    const { sshUser, sshPort, installationPath, ip } = $item;\n\n                    if (!sshUser || !sshPort || !installationPath || !ip) {\n                        throw new UserError(\"Не заполнены все данные для работы\");\n                    }\n\n                    const client = await $db.get(\"clients\", { serversIds: $item._id });\n\n                    const sshConnectionBaseCmd = `ssh -p ${sshPort} ${sshUser}@${ip}`;\n\n                    try {\n                        await asyncModules.exec(`${sshConnectionBaseCmd} 'ls ${installationPath}/remote-agent/'`);\n                    } catch (err) {\n                        console.info(`'ls ${installationPath}/remote-agent/' is not exists, try to created`, err);\n                        asyncModules.exec(`${sshConnectionBaseCmd} 'mkdir ${installationPath}/remote-agent/'`);\n                        await asyncModules.exec(`${sshConnectionBaseCmd} 'ls ${installationPath}/remote-agent/'`);\n                    }\n\n                    try {\n                        tmpDir = await asyncModules.mkdtemp(`${tmpDir}/cl_${client.uniqueId}-`);\n                        asyncModules.exec(`scp -P ${sshPort} ${remoteAgentDist} ${sshUser}@${ip}:${installationPath}/remote-agent/`);\n                        const pm2Config = {\n                            apps: [{\n                                name: \"RemoteAgentClient\",\n                                script: `${installationPath}/remote-agent/remote-agent_linux_amd64`,\n                                cwd: `${installationPath}/remote-agent/`,\n                                merge_logs: true\n                            }]\n                        };\n                        const pm2ConfJson = JSON.stringify(pm2Config, null, \"  \");\n                        const pm2confFile = `${tmpDir}/remote-agent_pm2.json`;\n                        asyncModules.writeFile(pm2confFile, pm2ConfJson);\n                        const racConfig = {\n                            key: `${client._id}`,\n                            clientId: `${client.uniqueId}`,\n                            logLevel: \"debug\",\n                            serverAddress: `${cloudURI}`,\n                            ami: {\n                                host: \"127.0.0.1\",\n                                username: \"admin\",\n                                password: \"amp111\"\n                            },\n                            files: {}\n                        };\n                        const racConfigJson = JSON.stringify(racConfig, null, \"  \");\n                        const racConfFile = `${tmpDir}/config.json`;\n                        asyncModules.writeFile(racConfFile, racConfigJson);\n                        await asyncModules.exec(`scp -P ${sshPort} ${pm2confFile} ${sshUser}@${ip}:${installationPath}/remote-agent/`);\n                        await asyncModules.exec(`scp -P ${sshPort} ${racConfFile} ${sshUser}@${ip}:${installationPath}/remote-agent/`);\n                        await asyncModules.unlink(pm2confFile);\n                        await asyncModules.unlink(racConfFile);\n                        await asyncModules.rmdir(tmpDir);\n                        await asyncModules.exec(`${sshConnectionBaseCmd} 'cd ${installationPath}/remote-agent/; pm2 start remote-agent_pm2.json; pm2 save'`);\n                    } catch (err) {\n                        console.error(\"Can't copy remote-agent to remote server\");\n                        throw err;\n                    }\n                };\n\n                return fn();\n            ","groupAccess":"","ownerAccess":"","props":null},{"_id":"changeRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Сменить релиз","multi":false,"script":"\n                if ($item.releaseId === $data.releaseId) {\n                    throw new UserError(\"Вы выбрали уже установленный релиз\");\n                }\n                const fn = async () =\u003e {\n                    const release = await $db.get(\"releases\", $data.releaseId);\n                    const query = { query: { major: release.version }, take: 1, orderBy: { minor: -1, patch: -1 }, props: [\"_id\"] };\n                    const cfAsteriskReleases = await $db.find(\"cfAsteriskReleases\", query);\n                    if (!cfAsteriskReleases || cfAsteriskReleases.count === 0) {\n                        throw new UserError(\"Нет подходящей версии cfAsterisk\");\n                    }\n\n                    const cfToolsReleases = await $db.find(\"cfToolsReleases\", query);\n                    if (!cfToolsReleases || cfToolsReleases.count === 0) {\n                        throw new UserError(\"Нет подходящей версии cfTools\");\n                    }\n\n                    const cfAgentBackReleases = await $db.find(\"cfAgentBackReleases\", query);\n                    if (!cfAgentBackReleases || cfAgentBackReleases.count === 0) {\n                        throw new UserError(\"Нет подходящей версии cfAgentBack\");\n                    }\n\n                    let eventBusReleases = await $db.find(\"eventBusReleases\", query, { returnNull: true });\n                    if (!eventBusReleases || eventBusReleases.count === 0) {\n                                                eventBusReleases = { items: [{ _id: null }] };\n                    }\n\n                    const update = {\n                        _id: $item._id,\n                        releaseId: release._id,\n                        releaseVersion: release.version,\n                        cfAgentBackReleaseId: cfAgentBackReleases.items[0]._id,\n                        cfAsteriskReleaseId: cfAsteriskReleases.items[0]._id,\n                        cfToolsReleaseId: cfToolsReleases.items[0]._id,\n                        eventBusReleaseId: eventBusReleases.items[0]._id\n                    };\n                    await $db.set(\"servers\", update);\n                };\n\n                return fn();\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formTab":"components","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"sortBy":"-createdAt","required":true,"store":"releases"}}},{"_id":"updateCfAgentBackRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"cfAgentBack\", $item, $data, $user).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, cfAgentBackReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","formLabel":"Обновление cfAgentBack","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"cfAgentBackReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить?","type":"bool","formOrder":10,"groupAccess":"","ownerAccess":"","display":"checkbox"},"restartServices":{"name":"","label":"Выберите сервисы","type":"any","formOrder":10,"groupAccess":"","ownerAccess":"","display":"checkList","default":["WebServer","ESL","SRT","AppPacker","DADataLoader","KPI","PDF"],"hidden":"!$item.restart","options":[{"label":"Веб сервер","value":"WebServer"},{"label":"EventSocketListener","value":"ESL"},{"label":"ServerRealTime","value":"SRT"},{"label":"App Packer","value":"AppPacker"},{"label":"DA Data Loader","value":"DADataLoader"},{"label":"KPI","value":"KPI"},{"label":"PDF report generator","value":"PDF"}]}}},{"_id":"restartCfAgentBack","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезапустить","multi":false,"script":"\n                if (!$data.restart) {\n                    throw new UserError(\"Требуется подтверждение перезапуска!\");\n                }\n\n                return require(\"releases\").restartComponent(\"cfAgentBack\", $item, $user, $data);\n            ","groupAccess":"","ownerAccess":"","props":{"restart":{"name":"","label":"Точно перезапустить!","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true},"restartServices":{"name":"","label":"Выберите сервисы","type":"any","formOrder":10,"groupAccess":"","ownerAccess":"","display":"checkList","default":["WebServer","ESL","SRT","AppPacker","DADataLoader","KPI","PDF"],"options":[{"label":"Веб сервер","value":"WebServer"},{"label":"EventSocketListener","value":"ESL"},{"label":"ServerRealTime","value":"SRT"},{"label":"App Packer","value":"AppPacker"},{"label":"DA Data Loader","value":"DADataLoader"},{"label":"KPI","value":"KPI"},{"label":"PDF report generator","value":"PDF"}]}}},{"_id":"updateCfAsteriskRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                if ($data.restart) {\n                    $data.restartServices = [\"AsteriskConnector\"];\n                }\n\n                return require(\"releases\").updateComponent(\"cfAsterisk\", $item, $data, $user).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, cfAsteriskReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","formLabel":"Обновление cfAsterisk","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"cfAsteriskReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить?","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox"}}},{"_id":"restartCfAsterisk","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезапустить","multi":false,"script":"\n                if (!$data.restart) {\n                    throw new UserError(\"Требуется подтверждение перезапуска!\");\n                }\n\n                $data.restartServices = [\"AsteriskConnector\"];\n                return require(\"releases\").restartComponent(\"cfAsterisk\", $item, $user, $data);\n            ","groupAccess":"","ownerAccess":"","props":{"restart":{"name":"","label":"Точно перезапустить!","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true}}},{"_id":"updateCfToolsRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"cfTools\", $item, $data, $user).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, cfToolsReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","formLabel":"Обновление cfTools","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"cfToolsReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}}}},{"_id":"updateEventBusRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"eventBus\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, eventBusReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"eventBusReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить?","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox"}}},{"_id":"restartEventBus","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезапустить","multi":false,"script":"\n                if (!$data.restart) {\n                    throw new UserError(\"Требуется подтверждение перезапуска!\");\n                }\n\n                return require(\"releases\").restartComponent(\"eventBus\", $item, $user, $data);\n            ","type":"form","groupAccess":"","ownerAccess":"","props":{"restart":{"name":"","label":"Точно перезапустить!","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true}}},{"_id":"updateMonitoringRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"monitoring\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, monitoringReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"monitoringReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}}}},{"_id":"updateCfAgentPageRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"cfAgentPage\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, cfAgentPageReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"cfAgentPageReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}}}},{"_id":"updateTraefikRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"traefik\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, traefikReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"traefikReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true}}},{"_id":"restartTraefik","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезагрузить","multi":false,"script":"\n                if (!($data.restart || $data.reload)) {\n                    throw new UserError(\"Не указана команда!\");\n                }\n\n                return require(\"releases\").restartComponent(\"traefik\", $item, $user, $data);\n            ","type":"form","groupAccess":"","ownerAccess":"","props":{"reload":{"name":"","label":"Только перегрузить конфигурацию","type":"bool","formOrder":30,"groupAccess":"","ownerAccess":"","display":"checkbox","required":"!$item.restart"},"restart":{"name":"","label":"Перезапустить?","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":"!$item.reload"}}},{"_id":"updateGochingRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                return require(\"releases\").updateComponent(\"goching\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, gochingReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"gochingReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true}}},{"_id":"restartGoching","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезагрузить","multi":false,"script":"\n                if (!($data.restart || $data.reload)) {\n                    throw new UserError(\"Не указана команда!\");\n                }\n\n                return require(\"releases\").restartComponent(\"goching\", $item, $user, $data);\n            ","type":"form","groupAccess":"","ownerAccess":"","props":{"restart":{"name":"","label":"Точно перезапустить?","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":"!$item.reload"}}},{"_id":"updateEteryRelease","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Обновить","multi":false,"script":"\n                $data.restartServices = [\"etery\"];\n                return require(\"releases\").updateComponent(\"etery\", $item, $data, $user, $data).then(() =\u003e {\n                    return $db.set(\"servers\", { _id: $item._id, eteryReleaseId: $data.releaseId });\n                });\n            ","groupAccess":"","ownerAccess":"","props":{"releaseId":{"name":"","label":"Выберите релиз","type":"ref","formOrder":10,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name","description"],"sortBy":"-createdAt","required":true,"store":"eteryReleases","extraQuery":"\n                        if (!$item.releaseVersion) {\n                            return;\n                        }\n\n                        return {\n                            $or: [{ major: $item.releaseVersion }, { major: 0, minor: 0 }]\n                        };\n                    "},"releaseVersion":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","default":{"$expression":"\n                            return $baseItem.releaseVersion;\n                        "}},"restart":{"name":"","label":"Перезапустить?","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox"}}},{"_id":"restartEtery","disableItemReadyCheck":false,"hideInHeader":true,"showInList":false,"icon":"","label":"Перезапустить","multi":false,"script":"\n                if (!$data.restart) {\n                    throw new UserError(\"Требуется подтверждение перезапуска!\");\n                }\n\n                $data.restartServices = [\"etery\"];\n                return require(\"releases\").restartComponent(\"etery\", $item, $user, $data);\n            ","type":"form","groupAccess":"","ownerAccess":"","props":{"restart":{"name":"","label":"Точно перезапустить!","type":"bool","formOrder":20,"groupAccess":"","ownerAccess":"","display":"checkbox","required":true}}}],"navOrder":200,"display":"list,table","html":"","label":"{{$i18n.storeLabel}}","labels":[{"text":"Online","icon":"fa fa-power-off","showInList":1,"color":"green","hidden":"!$item.online"},{"text":"Offline","icon":"fa fa-power-off","showInList":1,"color":"red","hidden":"$item.online"}],"tableColumns":[{"label":"Название","prop":"name","tableLink":true},{"label":"IP адрес","prop":"ip"},{"label":"Версия ОС/Ядра","optional":true,"prop":"os"},{"label":"Директория установки","optional":true,"prop":"installationPath"},{"label":"Отдельная установка","optional":true,"prop":"standalone"}],"store":""},"settings":{"type":"single","groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"storeLabel":"Системные настройки"},"props":{"cloudURI":{"name":"","label":"Адрес для подключения клиентов к remote-agent-server","type":"string","formOrder":20,"groupAccess":"","ownerAccess":"","display":"textArea","tooltip":"Нужно указать домен и порт через двоеточие для подключения\u003cbr\u003eклиентских remote-agent к облачному серверу"},"encoderPath":{"name":"","label":"Файл кодировщика","type":"string","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textArea","tooltip":"Программа для кодирования информации о сервисах и хэш суммах"},"remoteAgentDist":{"name":"","label":"Путь к remote-agent-client","type":"string","formOrder":30,"groupAccess":"","ownerAccess":"","display":"textArea","tooltip":"Указать место расположения remote-agent-client\u003cbr\u003eдля первоначальной установки клиента"}},"filters":{},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":300,"display":"","html":"","label":"{{$i18n.storeLabel}}","store":""},"syslog":{"type":"","access":[{"role":"root","permissions":"vcrud","condition":null}],"groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"en":{"storeLabel":"Actions history"},"ru":{"storeLabel":"Журнал операций"}},"props":{"action":{"name":"","label":"Action","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"text"},"actionData":{"name":"","label":"Action data","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"text"},"actionSource":{"name":"","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":"select","options":[{"label":"JavaScript API","value":"JS"},{"label":"WAMP API","value":"WAMP"},{"label":"HTTP API","value":"HTTP"},{"label":"System","value":"System"}]},"createdAt":{"name":"","label":"DateTime","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":""},"itemId":{"name":"","label":"Item Id","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"store":{"name":"","label":"Store","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"text"},"userId":{"name":"","type":"ref","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none","readOnly":true,"store":"users","populateIn":"user"},"userName":{"name":"","label":"User","type":"virtual","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","load":"\n                    return $item.user ? $item.user.name : \"\";\n                "}},"filters":{},"objectLifeCycle":{},"storeLifeCycle":{},"formTabs":null,"navOrder":90,"display":"table","html":"","label":"{{$i18n.storeLabel}}","tableColumns":["createdAt","actionSource","userName","store","itemId","action","actionData"],"orderBy":"-createdAt","store":""},"traefikReleases":{"type":"","groupAccess":"","ownerAccess":"","navGroup":"moox","i18n":{"storeLabel":"Релизы Traefik"},"props":{"description":{"name":"","label":"Список изменений","type":"string","formTab":"main","formOrder":200,"groupAccess":"","ownerAccess":"","display":"textArea"},"file":{"name":"","label":"ZIP файл","type":"file","formTab":"main","formOrder":30,"groupAccess":"","ownerAccess":"","display":"","required":true,"store":"releaseFiles","disabled":"$item.file"},"installList":{"name":"","label":" ","type":"virtualRefList","formTab":"installs","formOrder":0,"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["name"],"tableColumns":[{"label":"Клиент","prop":"name","tableLink":true},{"label":"Уникальный номер","prop":"uniqueId"},{"label":"Дата установки","prop":"releaseDate"}],"store":"clients","foreignKey":"releaseId","disabled":true},"major":{"name":"","label":"Мажорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"minor":{"name":"","label":"Минорная версия","type":"int","formTab":"main","formOrder":0,"groupAccess":"","ownerAccess":"","display":"numberInput","required":true,"hidden":"$item.$state !== 'new'"},"name":{"name":"","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"","disabled":true},"patch":{"name":"","type":"int","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"releaseDate":{"name":"","label":"Дата выпуска","type":"date","formTab":"main","formOrder":20,"groupAccess":"","ownerAccess":"","display":"dateTimePicker","hidden":"$item.$state === 'new'","disabled":true},"version":{"name":"","label":"Версия","type":"string","formTab":"main","formOrder":10,"groupAccess":"","ownerAccess":"","display":"textInput","hidden":"$item.$state === 'new'","disabled":true}},"filters":{},"objectLifeCycle":{"willCreate":"\n                if ($item.major == null || $item.minor == null) {\n                    throw new UserError(\"version missed\");\n                }\n\n                return $db.nextSequence(`traefik-${$item.major}-${$item.minor}`).then(res =\u003e {\n                    $item.patch = res;\n                    return require(\"releasesLifeCycle\").willSave($item);\n                });\n            ","willSave":"\n                return require(\"releasesLifeCycle\").willSave($item);\n            ","didRemove":"\n                if (!$item.file || $item.file.length == 0) {\n                    return;\n                }\n\n                const files = require(\"files\");\n                files.del(\"releaseFiles\", $item.file[0]._id).catch(err =\u003e {\n                    console.error(`[traefikReleases][didRemove] can't del file ${$item.file[0]._id}`, err);\n                });\n            "},"storeLifeCycle":{},"formTabs":[{"_id":"main","label":"Основная информация"},{"_id":"installs","label":"Установки"}],"navOrder":70,"display":"list","html":"","label":"{{$i18n.storeLabel}}","orderBy":"-createdAt","indexes":[[{"name":1},{"unique":true}]],"store":""},"users":{"type":"directory","access":[{"role":"root","permissions":"vcrudx","condition":null},{"role":"all","permissions":"r","condition":{"_id":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","navGroup":"config","i18n":{"en":{"activeLabel":"Enabled","createdAt":"Registered: ","emailLabel":"Email","inactiveLabel":"Disabled","label":"Users","loginLabel":"Login","profileIdLabel":"Profile data"},"ru":{"activeLabel":"Включен","createdAt":"Зарегистрирован: ","emailLabel":"Email","inactiveLabel":"Отключен","label":"Пользователи","loginLabel":"Имя для входа","profileIdLabel":"Данные профиля"}},"headerProperty":"login","props":{"_activationExpires":{"name":"","type":"date","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"},"_activationToken":{"name":"","type":"string","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"},"_passwordResetExpires":{"name":"","type":"date","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"},"_passwordResetToken":{"name":"","type":"string","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"},"email":{"name":"","label":"{{$i18n.emailLabel}}","type":"string","formOrder":20,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"all","permissions":"r","condition":{"_id":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50,"pattern":"^\\S+@\\S+\\.\\S+$","disabled":"$item.$state !== 'new'"},"facebookId":{"name":"","type":"string","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"},"isActive":{"name":"","label":"Активен","type":"bool","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none","default":true},"lang":{"name":"","label":"Language","type":"string","formOrder":30,"groupAccess":"","ownerAccess":"","display":"select","default":"en","options":[{"label":"English","value":"en"},{"label":"Русский","value":"ru"}]},"login":{"name":"","label":"{{$i18n.loginLabel}}","type":"string","formOrder":10,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"all","permissions":"r","condition":{"_id":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","display":"textInput","maxLength":50,"disabled":"$item.$state !== 'new'"},"name":{"name":"","type":"","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"noPassword":{"name":"","type":"bool","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"password":{"name":"","type":"password","formOrder":0,"groupAccess":"","ownerAccess":"","display":"none"},"profileId":{"name":"","label":"{{$i18n.profileIdLabel}}","type":"ref","oppositeProp":"_ownerId","formOrder":0,"access":[{"role":"root","permissions":"crud","condition":null},{"role":"all","permissions":"r","condition":{"_id":{"$expression":"$user._id"}}}],"groupAccess":"","ownerAccess":"","display":"searchBox","searchBy":["login"],"store":"profiles","disabled":true},"roles":{"name":"","label":"Roles","type":"refList","formOrder":100,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"checkList","style":{"display":"block"},"store":"_roles","hidden":"$item._id === '00000000-0000-0000-0000-000000000000'"},"workspace":{"name":"","label":"Interface","type":"string","formOrder":40,"access":[{"role":"root","permissions":"crud","condition":null}],"groupAccess":"","ownerAccess":"","display":"none"}},"filters":null,"objectLifeCycle":{"willCreate":"\n\n            ","willRemove":"\n                if ($item._id === \"00000000-0000-0000-0000-000000000000\") {\n                    throw new UserError(\"Cannot delete root user\");\n                }\n            "},"storeLifeCycle":{"didStart":"\n                sync.once(\"$$usersDidStart\", () =\u003e {\n                    $db.waitForConnection().then(() =\u003e {\n                        console.log(\"Checking root user in DB...\");\n                        $db.get(\"users\", \"00000000-0000-0000-0000-000000000000\", (e, d) =\u003e {\n                            if (d == null || d._deleted) {\n                                console.log(\"Root user not exists, creating...\");\n                                $db.set(\"users\", {\n                                    _id: \"00000000-0000-0000-0000-000000000000\",\n                                    roles: [\"root\"],\n                                    login: \"root\",\n                                    password: \"toor\",\n                                }, (e, d) =\u003e {\n                                    if (e != null) {\n                                        console.error(\"Error while creating root user:\", e);\n                                    } else {\n                                        console.log(\"Root user created\");\n                                    }\n                                });\n                            } else {\n                                console.log(\"Root user OK\");\n                            }\n                        });\n                    });\n                });\n            "},"formTabs":null,"actions":[{"_id":"activate","disableItemReadyCheck":false,"hidden":"$item.isActive || $item._id === '00000000-0000-0000-0000-000000000000'","hideInHeader":false,"showInList":false,"icon":"","label":"Enable","multi":false,"script":"\n                    return $db.set(\"users\", { _id: $item._id, isActive: true, _activationToken: null });\n                ","groupAccess":"","ownerAccess":"","props":null},{"_id":"deactivate","disableItemReadyCheck":false,"hidden":"!$item.isActive || $item._id === '00000000-0000-0000-0000-000000000000'","hideInHeader":false,"showInList":false,"icon":"material-icons text md-16 block","label":"Disable","multi":false,"script":"\n                    return $db.set(\"users\", { _id: $item._id, isActive: false });\n                ","groupAccess":"","ownerAccess":"","props":null},{"_id":"changePassword","disableItemReadyCheck":false,"hideInHeader":false,"showInList":false,"icon":"","label":"Change password","multi":false,"script":"\n                    if (!$data.newPassword) {\n                        throw new UserError(\"Please provide new password\");\n                    }\n                    return $db.set(\"users\", { _id: $item._id, password: $data.newPassword });\n                ","type":"form","groupAccess":"","ownerAccess":"","props":{"newPassword":{"name":"","label":"New password","type":"string","formOrder":0,"groupAccess":"","ownerAccess":"","display":"textInput","required":true}}}],"navOrder":0,"display":"","html":"","label":"{{$i18n.label}}","labels":[{"icon":"fa fa-power-off","showInList":1,"hideInForm":true,"color":"{{#if $item.isActive}}#43A047{{else}}#ddd{{/if}}"},{"text":"{{#if $item.isActive}}{{$i18n.activeLabel}}{{else}}{{$i18n.inactiveLabel}}{{/if}}","color":"{{#if $item.isActive}}#00E676{{else}}#E0E0E0{{/if}}"},{"text":"{{$i18n.createdAt}} {{moment $item.createdAt format=\"D MMMM, dd, HH:mm\"}}","showInList":2,"hideInForm":true,"hidden":"!$item.createdAt"}],"httpHooks":[{"uri":"activation/:token","method":"GET","script":"\n                    let fs = require(\"fs\");\n                    let handlebars = require(\"handlebars\");\n                    let user;\n                    return $db.get(\"users\", { _activationToken: $request.params[\"token\"] }).then(_user =\u003e {\n                        user = _user;\n                        return $db.set(\"users\", { _id: user._id, _activationToken: null, _activationExpires: null, isActive: true });\n                    }).then(() =\u003e {\n                        return fs.readLib(\"templates/activation-success.html\");\n                    }).then(template =\u003e {\n                        let body = handlebars.compile(template)({ user: user });\n                        return {\n                            type: \"html\",\n                            data: body,\n                        };\n                    }).catch(err =\u003e {\n                        console.debug(`[user activation] user not found with token: ${$request.params[\"token\"]}`, err);\n                        return fs.readLib(\"templates/activation-error.html\");\n                    }).then(template =\u003e {\n                        if (typeof template === \"object\") {\n                            return template;\n                        }\n                        let body = handlebars.compile(template)({});\n                        return {\n                            type: \"html\",\n                            data: body,\n                        };\n                    }).catch(err =\u003e {\n                        console.debug(`[user activation] error processing activation with token: ${$request.params[\"token\"]}`, err);\n                        return {\n                            type: \"html\",\n                            data: \"activation error\",\n                        };\n                    });\n                "}],"tasks":[{"schedule":"*/30  *   *   *   *","script":"\n                                        $db.find(\"users\", {\n                        query: {\n                            _activationExpires: { $lte: new Date() },\n                            isActive: false,\n                        },\n                        take: 100,\n                    }).then(res =\u003e {\n                        if (res.items.length \u003e 0) {\n                            console.debug(`[users][tasks][delete unactivated users] found ${res.items.length} unactivated users`);\n                            let promises = [];\n                            for (let user of res.items) {\n                                promises.push($db.delete(\"users\", user._id, { drop: true }));\n                            }\n                            return Promise.all(promises);\n                        }\n                    }).catch(err =\u003e {\n                        console.error(\"[users][tasks] can't process unactivated users\");\n                    }).then(() =\u003e {\n                                                return $db.find(\"users\", {\n                            query: {\n                                _passwordResetExpires: { $lte: new Date() },\n                            },\n                            take: 100,\n                        });\n                    }).then(res =\u003e {\n                        if (res.items.length \u003e 0) {\n                            console.debug(`[users][tasks][rotten password reset requests] found ${res.items.length} rotten requests`);\n                            let promises = [];\n                            for (let user of res.items) {\n                                promises.push($db.set(\"users\", { _id: user._id, _passwordResetExpires: null, _passwordResetToken: null }));\n                            }\n                            return Promise.all(promises);\n                        }\n                    }).catch(err =\u003e {\n                        console.error(\"[users][tasks] can't process rotten password reset requests\");\n                    });\n                "}],"store":""}}